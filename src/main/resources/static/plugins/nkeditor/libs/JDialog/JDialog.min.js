!function(i){function n(i){return(i+"_"+Math.random()).replace("0.","")}function t(){return Math.max(document.documentElement.clientHeight,document.body.clientHeight,i(document).height())+document.documentElement.scrollTop}function o(){return i(window).height()}function e(){return i(window).width()}function a(){return window.document.body.scrollTop||window.document.documentElement.scrollTop}function c(i){return"[object Array]"===Object.prototype.toString.apply(i)}function d(i){return"[object Object]"===Object.prototype.toString.apply(i)}i.fn.setPosition=function(n,t,l,s){var r,w,u=0,p=0,f=e(),h=o();if(s){var g=i(s).offset();u=g.left,p=g.top,f=i(s).width(),h=i(s).height()}else p=a();switch(l){case"cc":r=p+(h-t)/2,w=u+(f-n)/2;break;case"lt":r=p+JDialog.margin,w=JDialog.margin+u;break;case"tc":r=p+JDialog.margin,w=u+(f-n)/2;break;case"rt":r=p+JDialog.margin,w=u+f-n-JDialog.margin;break;case"lc":r=p+(h-t)/2,w=u+JDialog.margin;break;case"rc":r=p+(h-t)/2,w=u+f-n-JDialog.margin;break;case"lb":r=p+h-t-JDialog.margin,w=u+JDialog.margin;break;case"rb":r=p+h-t-JDialog.margin,w=u+f-n-JDialog.margin;break;case"bc":r=p+h-t-JDialog.margin,w=u+(f-n)/2;break;default:"number"==typeof l?(r=p+l,w=u+(f-n)/2):d(l)?(r=p+l.top,w=u+l.left):c(l)&&(r=p+l[0],w=u+l[1])}return i(this).css({width:n+"px",height:t+"px",top:r+"px",left:w+"px"}),this};var l=function(n){function o(){null==d&&(d=i('<div id="'+n.id+'" class="lock_panel"></div>'),d.css({"background-color":n.bgcolor}),i("body").append(d),a(),d.fadeIn(300),i(window).bind("resize",function(){a()}))}function a(){d.css({opacity:n.opacity,width:e(),height:t()})}var c={},d=null;return c.hide=function(){d.fadeOut(JDialog.transitionTime,function(){d.remove()})},c.getId=function(){return n.id},o(),c},s=function(n){function t(){if(null==e){switch(e=i('<div class="jtip_box animated" id="'+n.id+'"></div>'),a=i('<div class="jtip_left_icon"><!--提示图标--></div>'),c=i('<div class="jtip_content"></div>'),d=i('<div class="jtip_right"><!--右边圆角--></div>'),e.css("animation-name",n.effect),e.append(a),e.append(c),e.append(d),i("body").append(e),c.html(n.content),n.type){case"ok":a.addClass("jtip_ok");break;case"error":a.addClass("jtip_error");break;case"loading":l=i('<em class="jtip_loading_icon"></em>');var t=i('<div id="jtip_loading" class="jtip_load_img"></div>');t.append(l),a.addClass("jtip_loading"),t.insertAfter(a);break;default:a.addClass("jtip_warn")}e.show()}}function o(){var i=n.width;i||(i=a.width()+c.width()+21+d.width(),null!=l&&(i+=l.width())),e.setPosition(i,e.height(),n.offset,n.container)}var e,a,c,d,l,s={};return s.hide=function(){e.css("animation-name","zoomOut"),setTimeout(function(){e.remove(),"function"==typeof n.callback&&n.callback(s)},JDialog.transitionTime),null!=s.locker&&s.locker.hide()},s.getId=function(){return n.id},i(window).bind("resize",function(){o()}),n.lock&&(s.locker=JDialog.lock()),t(),o(),s},r=function(n){var t={};return t.winBox=null,t.create=function(){t.winBox=i('<div id="'+n.id+'" class="jdialog_win_box jdialog_win_'+n.skin+' animated"></div>'),t.winBox.addClass("box-shadow");var o=i('<div class="jdialog_win_title_box"></div>'),e=i('<div class="jdialog_win_title">'+n.title+"</div>"),a=i('<div class="jdialog_win_button"></div>'),c=i('<a class="jdialog_win_max_button" href="javascript:void(0)" title="最大化"></a>'),d=i('<a class="jdialog_win_close_button" href="javascript:void(0)" title="关闭"></a>');c.on("click",function(i){t.resizeToMax(),i.stopPropagation()}),d.on("click",function(){t.close()}),n.maxEnable&&a.append(c),n.closeBtn&&a.append(d),o.append(e),o.append(a),n.hasTitle&&t.winBox.append(o);var l=i('<div class="jdialog_win_CBOX"></div>'),s=i('<span class="jdialog_win_icon"></span>'),r=i('<div class="jdialog_win_content"></div>');r.append(n.content),"none"!=n.icon&&l.append(s),l.append(r),t.winBox.append(l);var w=i('<div class="jdialog_win_button_container"></div>'),u=i('<div class="jdialog_win_buttonInner"></div>');if(n.button){var p=function(n,o){var e=i('<a href="javascript:void(0);" class="btn btn-primary">'+n+"</a>");return e.click(function(){o(t)}),e};for(var f in n.button){var h=new p(f,n.button[f]);u.append(h)}w.append(u),t.winBox.append(w)}t.winBox.data("me",{title:e,content:l,max_btn:c}),o.mousedown(function(n){var o=n.pageX-t.winBox.position().left,e=n.pageY-t.winBox.position().top;i(document).mousemove(function(i){window.getSelection?window.getSelection().removeAllRanges():document.selection.empty(),t.winBox.css({top:i.pageY-e+"px",left:i.pageX-o+"px"})})}).mouseup(function(){i(document).unbind("mousemove")}),i("body").append(t.winBox),t.setIcon(n.icon)},t.setIcon=function(i){"none"!=i&&t.winBox.find(".jdialog_win_icon").addClass("jdialog_win_icon_"+i)},t.setPosition=function(){var i=n.height>0?n.height:t.winBox.height();0==n.height&&void 0!=n.button&&(i+=60),n.height=i,t.winBox.setPosition(n.width,n.height,n.offset,n.container),"none"==n.icon?t.winBox.find(".jdialog_win_content").css({width:"100%"}):t.winBox.find(".jdialog_win_content").css({width:t.winBox.width()-20-t.winBox.find(".jdialog_win_icon").width()-15+"px"}),n.button&&t.winBox.find(".jdialog_win_CBOX").height(n.height-115)},t.show=function(){null!=t.winBox&&(n.lock&&(t.locker=JDialog.lock()),t.winBox.css("animation-name",n.effect).show())},t.clear=function(){null!=t.winBox&&(t.winBox.find(".jdialog_win_CBOX").empty(),t.setPosition())},t.resizeToMax=function(){var n=t.winBox.data("smax"),c=t.winBox.data("me").max_btn;void 0==n?(t.winBox.data("smax",{top:t.winBox.position().top,left:t.winBox.position().left,width:t.winBox.width()+2*parseInt(t.winBox.css("border-width")),height:t.winBox.height()+2*parseInt(t.winBox.css("border-width"))}),i("body").css("overflow","hidden"),t.winBox.animate({top:a(),left:0,width:e(),height:o(),opacity:1},"fast"),c.attr({"class":"jdialog_win_reduce_button",title:"还原"})):(t.winBox.animate({top:n.top,left:n.left,width:n.width,height:n.height,opacity:1},"fast"),t.winBox.removeData("smax"),c.attr({"class":"jdialog_win_max_button",title:"最大化"}),i("body").css("overflow","auto"))},t.lock=function(){var n=i('<div class="jwindow-lock"></div>'),o=t.winBox.find(".jdialog_win_title_box").height();n.css({top:o,left:0,width:t.winBox.width()+"px",height:t.winBox.height()-o+"px"}),t.winBox.append(n)},t.unlock=function(){t.winBox.find(".jwindow-lock").remove()},t.close=function(){t.winBox.css("animation-name","zoomOut"),setTimeout(function(){t.winBox.remove()},JDialog.transitionTime),t.locker&&t.locker.hide()},t.getId=function(){return n.id},i(window).bind("resize",function(){t.setPosition()}),t.create(),t.setPosition(),t.show(),t.options=n,t},w=function(n){var t={};n.lock&&(t.locker=JDialog.lock({bgcolor:"#ffffff",opacity:.3}));var o=i('<i id="'+n.id+'" class="loader-icon"></i>');return i("body").append(o),o.setPosition(o.width(),o.height(),n.offset,n.container).addClass("loader-icon-"+n.skin),t.hide=function(){o.remove(),t.locker&&t.locker.hide(),"function"==typeof n.callback&&n.callback()},t},u=document.scripts,p=u[u.length-1],f=p.src,h=f.substring(0,f.lastIndexOf("/")+1)+"/static/plugins/nkeditor/libs/JDialog/css/JDialog.css";i("head:eq(0)").append('<link href="'+h+'" rel="stylesheet" type="text/css" />'),window.JDialog={margin:10,transitionTime:300,lock:function(t){t=t||{};var o=i.extend({id:n("lock"),timer:0,bgcolor:"#000000",opacity:.5},t),e=new l(o);return o.timer>0&&setTimeout(function(){e.hide()},o.timer),e},msg:function(t){"string"==typeof t&&(t={content:t}),t=t||{};var o=i.extend({id:n("tip"),effect:"zoomIn",type:"warn",content:"Hello, World.",offset:"cc",lock:!1,callback:function(){},timer:2e3},t),e=new s(o);return o.timer>0&&setTimeout(function(){e.hide()},o.timer),e},open:function(t){"string"==typeof t&&(t={content:t}),t=t||{};var a=i.extend({id:n("window"),title:"This is the title",content:"Hello, this is the content.",width:600,height:0,hasTitle:!0,lock:!0,skin:"default",offset:"cc",effect:"zoomIn",maxEnable:!1,closeBtn:!1,icon:"none",maxWidth:1920},t);return a.width<100&&(a.width=a.width*e()/100),a.height<100&&(a.height=a.height*o()/100),new r(a)},alert:function(i){i=i||{},i.width||(i.width=300);var n=this.open({title:i.title,content:'<div style="padding-top:13px; font-size:16px; vertical-align: middle;">'+i.content+"</div>",icon:i.icon,width:i.width,closeBtn:!0,button:{"确定":function(){n.close(),"function"==typeof i.callback&&i.callback(n)}}});return n},confirm:function(i){return i.content='<div style="padding-top:13px; font-size:14px;">'+i.content+"</div>",i.width||(i.width=300),i.closeBtn=!0,i.icon||(i.icon="warn"),this.open(i)},loader:function(t){var o=i.extend({id:n("loader"),skin:4,container:"",offset:"cc",lock:!0,timer:2e3},t),e=new w(o);return o.timer&&setTimeout(function(){e.hide()},o.timer),e}}}(jQuery);